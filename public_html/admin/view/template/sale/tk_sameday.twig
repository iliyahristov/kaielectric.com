{{ header }}{{ column_left }}
<div id="content">
	<div class="page-header">
		<div class="container-fluid">
			<div class="pull-right">
				<a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a>
			</div>
			<h1>{{ heading_title }}</h1>
			<ul class="breadcrumb">
				{% for breadcrumb in breadcrumbs %}
					<li><a href="{{ breadcrumb['href'] }}">{{ breadcrumb['text'] }}</a></li>
				{% endfor %}
			</ul>
		</div>
	</div>
	<div class="container-fluid">
		{% if error_warning %}
			<div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
				<button type="button" class="close" data-dismiss="alert">&times;</button>
			</div>
		{% endif %}
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title"><i class="fa fa-pencil"></i> {{ heading_title }}</h3>
			</div>
			<div class="panel-body">
				<form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-sameday" class="form-horizontal">
					
					<div class="form-group">
						<b><label class="col-sm-4 control-label" for="shipping_sameday_note">{{ text_calculate }}</label></b>
						<div class="col-sm-8">
							{% if calculate and calculate == 1 %}
								<p>{{ text_amount }}: {{ amount }}, {{ text_currency }}: {{ currency }}, {{ text_time }}: {{ time }}</p>
								<a onclick="$('#form-sameday').submit();" class="btn btn-primary">2 - {{ button_create }}</a>
							{% else %}
								<a onclick="$('#form-sameday').submit();" class="btn btn-primary">1	- {{ button_calculate }}</a>
							{% endif %}
							
							<input type="hidden" id="calculate" name="calculate" value="{{ calculate }}"/>
							
						</div>
					</div>
					
					<hr>
					
					<div class="form-group">
						<label class="col-sm-4 control-label">{{ text_sameday_pickup }}</label>
						<div class="col-sm-8">
							<select class="form-control" name="pickup_point">
								{% for pickup in sameday_pickups %}
									<option value="{{ pickup.sameday_id }}" {% if (pickup.sameday_id == pickup_point) %}selected="selected"{% endif %}>{{ pickup.sameday_id }} - {{ pickup.sameday_alias }} - {{ pickup.address }}</option>
								{% endfor %}
							</select>
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label">{{ text_return_pickup_point }}</label>
						<div class="col-sm-8">
							<select class="form-control" name="return_pickup_point">
								{% for pickup in sameday_pickups %}
									<option value="{{ pickup.sameday_id }}" {% if (pickup.sameday_id == return_pickup_point) %}selected="selected"{% endif %}>{{ pickup.sameday_id }} - {{ pickup.sameday_alias }} - {{ pickup.address }}</option>
								{% endfor %}
							</select>
						</div>
					</div>
					
					{% if pickup_point and sameday_contact_persons %}
						<div class="form-group">
							<label class="col-sm-4 control-label">{{ text_sameday_contact_persons }}</label>
							<div class="col-sm-8">
								<select class="form-control" name="contact_person">
									{% for person in sameday_contact_persons[pickup_point] %}
										<option value="{{ person.id }}" {% if (person.id == contact_person) %}selected="selected"{% endif %}>{{ person.id }} - {{ person.name }} - {{ person.phoneNumber }} - {{ person.email }}</option>
									{% endfor %}
								</select>
							</div>
						</div>
					{% endif %}
					
					<div class="form-group">
						<label class="col-sm-4 control-label">{{ text_package_type }}</label>
						<div class="col-sm-8">
							<select class="form-control" name="package_type">
								<option value="0" {% if (package_type == 0) %}selected="selected"{% endif %}>Package</option>
								<option value="1" {% if (package_type == 1) %}selected="selected"{% endif %}>Envelope</option>
								<option value="2" {% if (package_type == 2) %}selected="selected"{% endif %}>Large Package</option>
							</select>
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label">{{ text_weight }}</label>
						<div class="col-sm-8">
							<input class="form-control" type="text" name="weight" value="{{ weight }}"/>
							{% if (error_weight) %}
								<span class="text-danger">{{ error_weight }}</span>
							{% endif %}
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label" for="shipping_sameday_count">{{ text_parcels_count }}</label>
						<div class="col-sm-8">
							<input class="form-control" type="text" id="shipping_sameday_count" name="count" value="{{ count }}"/>
							{% if (error_count) %}
								<span class="text-danger">{{ error_count }}</span>
							{% endif %}
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label" for="shipping_sameday_width">{{ text_size }}</label>
						<div class="table-responsive col-sm-8">
							<table id="parcels_size" class="table table-striped table-bordered table-hover">
								<thead>
								<tr>
									<td class="text-left">{{ text_width }}</td>
									<td class="text-left">{{ text_height }}</td>
									<td class="text-left">{{ text_depth }}</td>
									<td class="text-left">{{ text_weight }}</td>
								</tr>
								</thead>
								<tbody>
								{% set parcels_size_row = 1 %}
								{% for parcels_size in parcels_sizes %}
									<tr id="parcel-size-row{{ parcels_size_row }}">
										<td class="text-left">
											<input type="text" name="parcels_size[{{ parcels_size_row }}][width]" value="{{ parcels_size['width'] }}"  class="form-control"/>
										</td>
										<td class="text-left">
											<input type="text" name="parcels_size[{{ parcels_size_row }}][height]" value="{{ parcels_size['height'] }}"  class="form-control"/>
										</td>
										<td class="text-left">
											<input type="text" name="parcels_size[{{ parcels_size_row }}][length]" value="{{ parcels_size['length'] }}"  class="form-control"/>
										</td>
										
										<td class="text-left">
											<input type="text" name="parcels_size[{{ parcels_size_row }}][weight]" value="{% if (parcels_size['weight']) %}{{ parcels_size['weight'] }}{% else %}{% if loop.first %}{{ weight }}{% endif %}{% endif %}"  class="form-control"/>
										</td>
									</tr>
									{% set parcels_size_row = parcels_size_row + 1 %}
								{% endfor %}
								</tbody>
							</table>
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label">{{ text_observation }}
							<div style="font-weight: normal">{{ text_contents_letters }}: <strong id="count-observation"></strong></div>
						</label>
						<div class="col-sm-8">
							<input class="form-control" type="text" id="observation" name="observation" value="{{ observation }}"/>
							{% if (error_observation) %}
								<span class="text-danger">{{ error_observation }}</span>
							{% endif %}
						</div>
					</div>
					<script>
              $('#observation').keyup(countname);
              $('#observation').keydown(countname);

              function countname() {
                  var cs_1_observation = $(this).val().length;
                  $('#count-observation').text(cs_1_observation);

                  if (cs_1_observation > 100 || cs_1_observation == 0) {
                      $('#count-observation').css('color', 'red');
                  } else {
                      $('#count-observation').css('color', 'green');
                  }
              }

              $(document).ready(function () {
                  var cs_2_observation = $('#observation').val().length;
                  $('#count-observation').text(cs_2_observation);

                  if (cs_2_observation > 100 || cs_2_observation == 0) {
                      $('#count-observation').css('color', 'red');
                  } else {
                      $('#count-observation').css('color', 'green');
                  }
              });
					
					</script>
					
					<div class="form-group">
						<label class="col-sm-4 control-label" >{{ text_client_observation }}</label>
						<div class="col-sm-8">
							<textarea class="form-control" type="text" name="client_observation" row="3">{{ client_observation }}</textarea>
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label">{{ text_cod }}</label>
						<div class="col-sm-8">
							<label class="radio-inline" style="display: inline; width: auto; float: none;">
								<input type="radio" name="cod" value="1" {% if (cod) %} checked="checked"{% endif %} onclick="$('#total_container').show();"/>
								{{ text_yes }}
							</label>
							<label class="radio-inline" style="display: inline; width: auto; float: none;">
								<input type="radio" name="cod" value="0" {% if (not cod) %} checked="checked"{% endif %} onclick="$('#total_container').hide();"/>
								{{ text_no }}
							</label>
						</div>
					</div>
					
					<div class="form-group" id="total_container" {% if (not cod) %} style="display: none;"{% endif %} >
						<label class="col-sm-4 control-label" >{{ text_total }}</label>
						<div class="col-sm-8">
							<input class="form-control" type="text" name="total" value="{{ total }}"/>
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label">{{ text_insured_value }}</label>
						<div class="col-sm-8">
							<input class="form-control" type="text" name="insured_value" value="{{ insured_value }}"/>
						</div>
					</div>
					
					<div class="form-group" id="selector_opening" {% if (shipping_to == 'locker') %} style="display: none;"{% endif %}>
						<label class="col-sm-4 control-label">{{ text_option }}</label>
						<div class="col-sm-8">
							<label class="radio-inline" style="display: inline; width: auto; float: none;">
								<input type="radio" name="opening" value="1" {% if (opening) %} checked="checked"{% endif %}"/>
								{{ text_yes }}
							</label>
							<label class="radio-inline" style="display: inline; width: auto; float: none;">
								<input type="radio" name="opening" value="0" {% if (not opening) %} checked="checked"{% endif %}/>
								{{ text_no }}
							</label>
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label">{{ text_name }}</label>
						<div class="col-sm-8">
							<input class="form-control" type="text" name="name" value="{{ name }}"/>
							{% if (error_name) %}
								<span class="text-danger">{{ error_name }}</span>
							{% endif %}
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label">{{ text_phone }}</label>
						<div class="col-sm-8">
							<input class="form-control" type="text" name="phone" value="{{ phone }}"/>
							{% if (error_phone) %}
								<span class="text-danger">{{ error_phone }}</span>
							{% endif %}
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label" >{{ text_mail }}</label>
						<div class="col-sm-8">
							<input class="form-control" type="text" name="email" value="{{ email }}"/>
						</div>
					</div>
					
					
					<div class="form-group">
						<label class="col-sm-4 control-label">{{ text_person_type }}</label>
						<div class="col-sm-8">
							<select class="form-control" name="person_type">
								<option value="0" {% if (person_type == 0) %}selected="selected"{% endif %}>Individual</option>
								<option value="1" {% if (person_type == 1) %}selected="selected"{% endif %}>Business</option>
							</select>
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-4 control-label" >{{ text_company }}</label>
						<div class="col-sm-8">
							<input class="form-control" type="text" name="company_name" value="{{ company_name }}"/>
						</div>
					</div>
					
					<hr>
					<div class="form-group">
						<label class="col-sm-4 control-label" >{{ text_service }}</label>
						<div class="col-sm-8">
							<select name="service" class="form-control">
								{% for sameday_service in sameday_services %}
									{% if sameday_service.id == service %}
										<option value="{{ sameday_service.id }}" selected="selected" data-type="{{ sameday_service.type }}">{{ sameday_service.name }}</option>
									{% else %}
										<option value="{{ sameday_service.id }}" data-type="{{ sameday_service.type }}">{{ sameday_service.name }}</option>
									{% endif %}
								{% endfor %}
							</select>
						</div>
					</div>
					
					<input type="hidden" id="sameday_shipping_to" name="shipping_to" value="{{ shipping_to }}"/>
					<input type="hidden" id="sameday_country_id" name="country_id" value="{{ country_id }}"/>
					<input type="hidden" id="sameday_country" name="country" value="{{ country }}"/>
					<input type="hidden" id="sameday_country_iso" name="country_iso" value="{{ country_iso }}"/>
					<input type="hidden" id="sameday_postcode" name="postcode" value="{{ postcode }}"/>
					<input type="hidden" id="sameday_county_id" name="county_id" value="{{ county_id }}"/>
					<input type="hidden" id="sameday_county" name="county" value="{{ county }}"/>
					<input type="hidden" id="sameday_city_id" name="city_id" value="{{ city_id }}"/>
					<input type="hidden" id="sameday_city" name="city" value="{{ city }}"/>
					<input type="hidden" id="sameday_locker_id" name="locker_id" value="{{ locker_id }}"/>
					<input type="hidden" id="sameday_locker_name" name="locker_name" value="{{ locker_name }}"/>
					<input type="hidden" id="sameday_locker_address" name="locker_address" value="{{ locker_address }}"/>
					
					<div id="sameday_address_container" {% if (shipping_to == 'locker') %} style="display: none;"{% endif %} >
						<div class="form-group">
							<label class="col-sm-4 control-label">{{ text_county }}</label>
							<div class="col-sm-8">
								<input class="form-control" type="text" id="sameday_address_county" name="sameday_address_county" value="{{ county }}"/>
								{% if (error_county) %}
									<span class="text-danger">{{ error_county }}</span>
								{% endif %}
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label">{{ text_city }}</label>
							<div class="col-sm-8">
								<input class="form-control" type="text" id="sameday_address_city" name="sameday_address_city" value="{{ city }}"/>
								{% if (error_city) %}
									<span class="text-danger">{{ error_city }}</span>
								{% endif %}
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label">{{ text_address }}</label>
							<div class="col-sm-8">
								<input class="form-control" type="text" id="sameday_address_address" name="address" value="{{ address }}"/>
								{% if (error_address) %}
									<span class="text-danger">{{ error_address }}</span>
								{% endif %}
							</div>
						</div>
					</div>
					
					<div id="sameday_locker_container" {% if (shipping_to == 'address') %} style="display: none;"{% endif %} >
						<div class="form-group">
							<label class="col-sm-4 control-label">{{ text_county }}</label>
							<div class="col-sm-8">
								<input class="form-control" type="text" id="sameday_locker_county" name="sameday_locker_county" value="{{ county }}"/>
								{% if (error_county) %}
									<span class="text-danger">{{ error_county }}</span>
								{% endif %}
							</div>
						</div><div class="form-group">
							<label class="col-sm-4 control-label">{{ text_city }}</label>
							<div class="col-sm-8">
								<input class="form-control" type="text" id="sameday_locker_city" name="sameday_locker_city" value="{{ city }}"/>
								{% if (error_city) %}
									<span class="text-danger">{{ error_city }}</span>
								{% endif %}
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label">{{ text_locker }}</label>
							<div class="col-sm-8">
								<input class="form-control" type="text" id="sameday_locker_locker" name="sameday_locker_locker" value="{% if locker_id %}{{ locker_id }} | {{ locker_name }} - {{ locker_address }}{% endif %}"/>
								{% if (error_locker) %}
									<span class="text-danger">{{ error_locker }}</span>
								{% endif %}
							</div>
						</div>
					</div>
				
				</form>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">

    $(document).delegate('select[name=\'service\']', 'change', function () {

        $('#sameday_locker_county').val('');
        $('#sameday_county').val('');
        $('#sameday_county_id').val('');
        $('#sameday_locker_city').val('');
        $('#sameday_city').val('');
        $('#sameday_city_id').val('');
        $('#sameday_postcode').val('');
        $('#sameday_locker_locker').val('');
        $('#sameday_locker_id').val('');
        $('#sameday_locker_name').val('');
        $('#sameday_locker_address').val('');
        
        var service_type = $(this).find(':selected').data('type');

		if (service_type == 'machine') {
			$('#sameday_locker_container').show();
			$('#sameday_address_container').hide();
			$('#selector_opening').hide();

			$('#sameday_shipping_to').val('locker');

		} else {
			$('#sameday_locker_container').hide();
			$('#sameday_address_container').show();
			$('#selector_opening').show();

			$('#sameday_shipping_to').val('address');
		}
    });
    
    $('#shipping_sameday_parcel_sizes, #client_id').on('change', function () {
        if ($('#calculate').val() == 1) {
            $('#calculate').val('0');
            $('#form-sameday').submit();
        }
    });

    var shipping_sameday_count_previous;

    $('#shipping_sameday_count').keydown(function (e) {
        if (!e.key.match(/\d/)) {
            e.preventDefault()
        }
    }).on('focus', function () {
        shipping_sameday_count_previous = parseInt($(this).val());
    }).change(function () {
        if (parseInt(shipping_sameday_count_previous) < parseInt($(this).val())) {
            addParcelsSize(parseInt(shipping_sameday_count_previous) + 1, parseInt($(this).val()));
        } else {
            removeParcelsSize(parseInt($(this).val()), parseInt(shipping_sameday_count_previous));
        }

        shipping_sameday_count_previous = parseInt($(this).val());
    });

    function addParcelsSize(old_rows, new_rows) {
        for (i = old_rows; i <= new_rows; i++) {
            html = '<tr id="parcel-size-row' + i + '">';
            html += ' <td class="text-left"><input type="text" name="parcels_size[' + i + '][width]" value="" placeholder="{{ text_width }}" class="form-control" /></td>';
            html += ' <td class="text-left"><input type="text" name="parcels_size[' + i + '][height]" value="" placeholder="{{ text_height }}" class="form-control" /></td>';
            html += ' <td class="text-left"><input type="text" name="parcels_size[' + i + '][length]" value="" placeholder="{{ text_depth }}" class="form-control" /></td>';
            html += ' <td class="text-left"><input type="text" name="parcels_size[' + i + '][weight]" value="" placeholder="{{ text_weight }}" class="form-control" /></td>';
            html += '</tr>';

            $('#parcels_size tbody').append(html);
        }
    }

    function removeParcelsSize(old_rows, new_rows) {
        for (i = new_rows; i > old_rows; i--) {
            $('#parcel-size-row' + i).remove();
        }
    }

    
    var sameday_county = '{{ county }}';
    var sameday_county_id = '{{ county_id }}';
    var sameday_city = '{{ city }}';
    var sameday_city_id = '{{ city_id }}';
    var sameday_postcode = '{{ postcode }}';
    var sameday_locker_id = '{{ locker_id }}';
    var sameday_locker_name = '{{ locker_name }}';
    var sameday_locker_address = '{{ locker_address }}';
    
    $(document).ready(function () {
		   
        $('#sameday_locker_county').autocomplete({
            'source': function (request, response) {
                    $.ajax({
                        url: 'index.php?route=sale/tk_sameday/getCounties&user_token={{ user_token }}',
                        dataType: 'json',
                        data: {
                            name: function () {
                                return $('#sameday_locker_county').val();
                            },
                            country_iso: function () {
                                return $('#sameday_country_iso').val();
                            }
                        },
                        success: function (data) {
                            if (data.error) {
                                alert(data.error);
                            } else {
                                response($.map(data.counties, function (item) {
                                    return {
		                                    label: item['name'],
                                        value: item['name'],
                                        county_id: item['county_id'],
                                        name: item['name'],
                                    }
                                }));
                            }
                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            //alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                        }
                    });
            },
            'select': function (item) {
                if (item) {
                    sameday_county = item.name;
                    sameday_county_id = item.county_id;
                    
                    $('#sameday_locker_county').val(item.name);
                    $('#sameday_county').val(item.name);
                    $('#sameday_county_id').val(item.county_id);
                }
            },
            'change': function (item) {
                $('#sameday_locker_county').val('');
                $('#sameday_county').val('');
                $('#sameday_county_id').val('');
                $('#sameday_locker_city').val('');
                $('#sameday_city').val('');
                $('#sameday_city_id').val('');
                $('#sameday_postcode').val('');
                $('#sameday_locker_locker').val('');
                $('#sameday_locker_id').val('');
                $('#sameday_locker_name').val('');
                $('#sameday_locker_address').val('');
            },
            'minLength': 0
        });

        $('#sameday_locker_county').blur(function () {
            if (($(this).val() != sameday_county)) {
                $('#sameday_locker_county').val('');
                $('#sameday_county').val('');
                $('#sameday_county_id').val('');
                $('#sameday_locker_city').val('');
                $('#sameday_city').val('');
                $('#sameday_city_id').val('');
                $('#sameday_postcode').val('');
                $('#sameday_locker_locker').val('');
                $('#sameday_locker_id').val('');
                $('#sameday_locker_name').val('');
                $('#sameday_locker_address').val('');
            }
        });

        $('#sameday_locker_city').autocomplete({
            'source': function (request, response) {
                    $.ajax({
                        url: 'index.php?route=sale/tk_sameday/getLockersCities&user_token={{ user_token }}',
                        dataType: 'json',
                        data: {
                            name: function () {
                                return $('#sameday_locker_city').val();
                            },
                            country_iso: function () {
                                return $('#sameday_country_iso').val();
                            },
                            county_id: function () {
                                return $('#sameday_county_id').val();
                            }
                        },
                        success: function (data) {
                            if (data.error) {
                                alert(data.error);
                            } else {
                                response($.map(data.cities, function (item) {
                                    return {
                                        label: item['name'],
                                        value: item['name'],
                                        city_id: item['city_id'],
                                        name: item['name'],
                                        postcode: item['postcode'],
                                    }
                                }));
                            }
                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            //alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                        }
                    });
            },
            'select': function (item) {
                if (item) {
                    sameday_city = item.name;
                    sameday_city_id = item.city_id;
                    sameday_postcode = item.postcode;

                    $('#sameday_locker_city').val(item.name);
                    $('#sameday_city').val(item.name);
                    $('#sameday_city_id').val(item.city_id);
                    $('#sameday_postcode').val(item.postcode);
                }
            },
            'change': function (item) {
                $('#sameday_locker_city').val('');
                $('#sameday_city').val('');
                $('#sameday_city_id').val('');
                $('#sameday_postcode').val('');
                $('#sameday_locker_locker').val('');
                $('#sameday_locker_id').val('');
                $('#sameday_locker_name').val('');
                $('#sameday_locker_address').val('');
            },
            'minLength': 0
        });

        $('#sameday_locker_city').blur(function () {
            if (($(this).val() != sameday_county)) {
                $('#sameday_locker_city').val('');
                $('#sameday_city').val('');
                $('#sameday_city_id').val('');
                $('#sameday_postcode').val('');
                $('#sameday_locker_locker').val('');
                $('#sameday_locker_id').val('');
                $('#sameday_locker_name').val('');
                $('#sameday_locker_address').val('');
            }
        });

        $('#sameday_locker_locker').autocomplete({
            'source': function (request, response) {
                    $.ajax({
                        url: 'index.php?route=sale/tk_sameday/getLockers&user_token={{ user_token }}',
                        dataType: 'json',
                        data: {
                            name: function () {
                                return $('#sameday_locker_locker').val();
                            },
                            country_iso: function () {
                                return $('#sameday_country_iso').val();
                            },
                            city_id: function () {
                                return $('#sameday_city_id').val();
                            }
                        },
                        success: function (data) {
                            if (data.error) {
                                alert(data.error);
                            } else {
                                response($.map(data.lockers, function (item) {
                                    return {
                                        label: item.locker_id + ' | ' + item.name + ' - ' + item.address,
                                        value: item['name'],
                                        locker_id: item['locker_id'],
                                        name: item['name'],
                                        address: item['address'],
                                    }
                                }));
                            }
                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            //alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                        }
                    });
            },
            'select': function (item) {
                if (item) {
                    sameday_locker_id = item.locker_id;
                    sameday_locker_name = item.name;
                    sameday_locker_address = item.address;

                    $('#sameday_locker_locker').val(item.locker_id + ' | ' + item.name + ' - ' + item.address);
                    $('#sameday_locker_id').val(item.locker_id);
                    $('#sameday_locker_name').val(item.name);
                    $('#sameday_locker_address').val(item.address);
                }
            },
            'change': function (item) {
                $('#sameday_locker_locker').val('');
                $('#sameday_locker_id').val('');
                $('#sameday_locker_name').val('');
                $('#sameday_locker_address').val('');
            },
            'minLength': 0
        });

        $('#sameday_locker_locker').blur(function () {
            if (($(this).val() != sameday_county)) {
                $('#sameday_locker_locker').val('');
                $('#sameday_locker_id').val('');
                $('#sameday_locker_name').val('');
                $('#sameday_locker_address').val('');
            }
        });


		$('#sameday_address_county').autocomplete({
			'source': function (request, response) {
				$.ajax({
					url: 'index.php?route=sale/tk_sameday/getCounties&user_token={{ user_token }}',
					dataType: 'json',
					data: {
						name: function () {
							return $('#sameday_address_county').val();
						},
						country_iso: function () {
							return $('#sameday_country_iso').val();
						}
					},
					success: function (data) {
						if (data.error) {
							alert(data.error);
						} else {
							response($.map(data.counties, function (item) {
								return {
									label: item['name'],
									value: item['name'],
									county_id: item['county_id'],
									name: item['name'],
								}
							}));
						}
					},
					error: function (xhr, ajaxOptions, thrownError) {
						//alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
					}
				});
			},
			'select': function (item) {
				if (item) {
					sameday_county = item.name;
					sameday_county_id = item.county_id;

					$('#sameday_address_county').val(item.name);
					$('#sameday_county').val(item.name);
					$('#sameday_county_id').val(item.county_id);
				}
			},
			'change': function (item) {
				$('#sameday_address_county').val('');
				$('#sameday_county').val('');
				$('#sameday_county_id').val('');
				$('#sameday_address_city').val('');
				$('#sameday_city').val('');
				$('#sameday_city_id').val('');
				$('#sameday_postcode').val('');
			},
			'minLength': 0
		});

		$('#sameday_address_county').blur(function () {
			if (($(this).val() != sameday_county)) {
				$('#sameday_address_county').val('');
				$('#sameday_county').val('');
				$('#sameday_county_id').val('');
				$('#sameday_address_city').val('');
				$('#sameday_city').val('');
				$('#sameday_city_id').val('');
				$('#sameday_postcode').val('');
			}
		});

		$('#sameday_address_city').autocomplete({
			'source': function (request, response) {
				$.ajax({
					url: 'index.php?route=sale/tk_sameday/getCities&user_token={{ user_token }}',
					dataType: 'json',
					data: {
						name: function () {
							return $('#sameday_address_city').val();
						},
						country_iso: function () {
							return $('#sameday_country_iso').val();
						},
						county_id: function () {
							return $('#sameday_county_id').val();
						}
					},
					success: function (data) {
						if (data.error) {
							alert(data.error);
						} else {
							response($.map(data.cities, function (item) {
								return {
									label: item['name'],
									value: item['name'],
									city_id: item['city_id'],
									name: item['name'],
									postcode: item['postcode'],
								}
							}));
						}
					},
					error: function (xhr, ajaxOptions, thrownError) {
						//alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
					}
				});
			},
			'select': function (item) {
				if (item) {
					sameday_city = item.name;
					sameday_city_id = item.city_id;
					sameday_postcode = item.postcode;

					$('#sameday_address_city').val(item.name);
					$('#sameday_city').val(item.name);
					$('#sameday_city_id').val(item.city_id);
					$('#sameday_postcode').val(item.postcode);
				}
			},
			'change': function (item) {
				$('#sameday_address_city').val('');
				$('#sameday_city').val('');
				$('#sameday_city_id').val('');
				$('#sameday_postcode').val('');
			},
			'minLength': 0
		});

		$('#sameday_address_city').blur(function () {
			if (($(this).val() != sameday_county)) {
				$('#sameday_address_city').val('');
				$('#sameday_city').val('');
				$('#sameday_city_id').val('');
				$('#sameday_postcode').val('');
			}
		});

    });
</script>
{{ footer }}