<?php

/* so-revo/template/common/footer.twig */
class __TwigTemplate_06e7ae890487834f6a0eeae2cbe81c5c397a2a7e63c1a59af42676a5b415dc07 extends Twig_Template
{
    public function __construct(Twig_Environment $env)
    {
        parent::__construct($env);

        $this->parent = false;

        $this->blocks = array(
        );
    }

    protected function doDisplay(array $context, array $blocks = array())
    {
        // line 2
        echo "
";
        // line 3
        if (($this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "1")) {
            // line 4
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer1.twig"), "so-revo/template/common/footer.twig", 4)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 5
            echo "
";
        } elseif (($this->getAttribute(        // line 6
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "2")) {
            // line 7
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer2.twig"), "so-revo/template/common/footer.twig", 7)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 8
            echo "\t
";
        } elseif (($this->getAttribute(        // line 9
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "3")) {
            // line 10
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer3.twig"), "so-revo/template/common/footer.twig", 10)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 11
            echo "\t
";
        } elseif (($this->getAttribute(        // line 12
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "4")) {
            // line 13
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer4.twig"), "so-revo/template/common/footer.twig", 13)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 14
            echo "\t
";
        } elseif (($this->getAttribute(        // line 15
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "5")) {
            // line 16
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer5.twig"), "so-revo/template/common/footer.twig", 16)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 17
            echo "\t
";
        } elseif (($this->getAttribute(        // line 18
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "6")) {
            // line 19
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer6.twig"), "so-revo/template/common/footer.twig", 19)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 20
            echo "\t
";
        } elseif (($this->getAttribute(        // line 21
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "7")) {
            // line 22
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer7.twig"), "so-revo/template/common/footer.twig", 22)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 23
            echo "
";
        } elseif (($this->getAttribute(        // line 24
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "8")) {
            // line 25
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer8.twig"), "so-revo/template/common/footer.twig", 25)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 26
            echo "\t
";
        } elseif (($this->getAttribute(        // line 27
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "9")) {
            // line 28
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer9.twig"), "so-revo/template/common/footer.twig", 28)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 29
            echo "\t
";
        } elseif (($this->getAttribute(        // line 30
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "10")) {
            // line 31
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer10.twig"), "so-revo/template/common/footer.twig", 31)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 32
            echo "
";
        } elseif (($this->getAttribute(        // line 33
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "11")) {
            // line 34
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer11.twig"), "so-revo/template/common/footer.twig", 34)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 35
            echo "
";
        } elseif (($this->getAttribute(        // line 36
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "12")) {
            // line 37
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer12.twig"), "so-revo/template/common/footer.twig", 37)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 38
            echo "
";
        } elseif (($this->getAttribute(        // line 39
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "13")) {
            // line 40
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer13.twig"), "so-revo/template/common/footer.twig", 40)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 41
            echo "
";
        } elseif (($this->getAttribute(        // line 42
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "14")) {
            // line 43
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer14.twig"), "so-revo/template/common/footer.twig", 43)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 44
            echo "\t
";
        } elseif (($this->getAttribute(        // line 45
(isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method") == "15")) {
            // line 46
            echo "\t";
            $this->loadTemplate(((isset($context["theme_directory"]) ? $context["theme_directory"] : null) . "/template/footer/footer15.twig"), "so-revo/template/common/footer.twig", 46)->display(array_merge($context, array("typefooter" => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "typefooter"), "method"))));
            // line 47
            echo "
";
        }
        // line 49
        echo "

<div id=\"previewModal\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\">
  <div class=\"modal-dialog modal-lg\" role=\"document\">
    <div class=\"modal-content\">
\t\t<div class=\"modal-header\">
\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>
\t\t\t<h4 class=\"modal-title\"> ";
        // line 56
        echo $this->getAttribute((isset($context["objlang"]) ? $context["objlang"] : null), "get", array(0 => "text_alertaddtocart"), "method");
        echo "</h4>
\t\t</div>
\t\t<div class=\"modal-body\"></div>
    </div>
  </div>
</div>
";
        // line 63
        echo "
";
        // line 64
        if ($this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "social_sidebar"), "method")) {
            // line 65
            echo "\t";
            if (($this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "social_sidebar"), "method") == 1)) {
                // line 66
                echo "\t\t";
                $context["social_sidebar"] = "socialwidgets-left";
                // line 67
                echo "\t";
            } else {
                // line 68
                echo "\t\t";
                $context["social_sidebar"] = "socialwidgets-right";
                // line 69
                echo "\t";
            }
            // line 70
            echo "\t<section class=\"social-widgets visible-lg ";
            echo (isset($context["social_sidebar"]) ? $context["social_sidebar"] : null);
            echo " \">
\t\t<ul class=\"items\">
\t\t\t";
            // line 72
            if ($this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "social_fb_status"), "method")) {
                echo " 
\t\t\t<li class=\"item item-01 facebook\">
\t\t\t\t<a href=\"catalog/view/theme/";
                // line 74
                echo (isset($context["theme_directory"]) ? $context["theme_directory"] : null);
                echo "/template/social/facebook.php?account_fb=";
                echo $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "facebook"), "method");
                echo " \" class=\"tab-icon\"><span class=\"fa fa-facebook\"></span></a>
\t\t\t\t<div class=\"tab-content\">
\t\t\t\t\t<div class=\"title\"><h5>";
                // line 76
                echo (isset($context["text_title_facebook"]) ? $context["text_title_facebook"] : null);
                echo "</h5></div>
\t\t\t\t\t<div class=\"loading\">
\t\t\t\t\t\t<img class=\"lazyload\" data-sizes=\"auto\" src=\"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" data-src=\"catalog/view/theme/";
                // line 78
                echo (isset($context["theme_directory"]) ? $context["theme_directory"] : null);
                echo "/images/ajax-loader.gif\" class=\"ajaxloader\" alt=\"loader\">
\t\t\t\t\t</div>
\t\t\t\t</div>
\t\t\t</li>
\t\t\t";
            }
            // line 82
            echo " 

\t\t\t";
            // line 84
            if ($this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "social_twitter_status"), "method")) {
                echo " 
\t\t\t<li class=\"item item-02 twitter\">
\t\t\t\t<a href=\"catalog/view/theme/";
                // line 86
                echo (isset($context["theme_directory"]) ? $context["theme_directory"] : null);
                echo "/template/social/twitter.php?account_twitter=";
                echo $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "twitter"), "method");
                echo " \" class=\"tab-icon\"><span class=\"fa fa-twitter\"></span></a>
\t\t\t\t<div class=\"tab-content\">
\t\t\t\t\t<div class=\"title\"><h5>";
                // line 88
                echo (isset($context["text_title_twitter"]) ? $context["text_title_twitter"] : null);
                echo "</h5></div>
\t\t\t\t\t<div class=\"loading\">
\t\t\t\t\t\t<img class=\"lazyload\" data-sizes=\"auto\" src=\"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" data-src=\"catalog/view/theme/";
                // line 90
                echo (isset($context["theme_directory"]) ? $context["theme_directory"] : null);
                echo "/images/ajax-loader.gif\" class=\"ajaxloader\" alt=\"loader\">
\t\t\t\t\t</div>
\t\t\t\t</div>
\t\t\t</li>
\t\t\t";
            }
            // line 94
            echo " 

\t\t\t";
            // line 96
            if ($this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "social_custom_status"), "method")) {
                echo " 
\t\t\t<li class=\"item item-03 youtube\">
\t\t\t\t<div class=\"tab-icon\"><span class=\"fa fa-youtube\"></span></div>
\t\t\t\t<div class=\"tab-content\">
\t\t\t\t\t<div class=\"loading\">
\t\t\t\t\t\t";
                // line 101
                if ($this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "video_code"), "method")) {
                    // line 102
                    echo "\t\t\t\t\t\t\t\t";
                    echo $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "decode_entities", array(0 => $this->getAttribute((isset($context["soconfig"]) ? $context["soconfig"] : null), "get_settings", array(0 => "video_code"), "method")), "method");
                    echo "
\t\t\t\t\t\t";
                }
                // line 103
                echo " 
\t\t\t\t\t</div>
\t\t\t\t</div>
\t\t\t</li>
\t\t\t";
            }
            // line 107
            echo " 
\t\t</ul>
\t</section>
\t
";
        }
        // line 111
        echo " 

</div>
<script>
\t\$('#so-groups').css('display', 'none');
\t
\t\$(window).scroll(function (event) {
    \tvar scroll = \$(window).scrollTop();
    \tif( scroll > \$(window).height()){
    \t\t\$('#so-groups').css('display', 'block');
    \t} else {
    \t\t\$('#so-groups').css('display', 'none');
    \t}
\t});
\t
</script>

            ";
        // line 128
        if ((isset($context["schemas_org"]) ? $context["schemas_org"] : null)) {
            // line 129
            echo "            ";
            $context['_parent'] = $context;
            $context['_seq'] = twig_ensure_traversable((isset($context["schemas_org"]) ? $context["schemas_org"] : null));
            foreach ($context['_seq'] as $context["_key"] => $context["schema"]) {
                // line 130
                echo "            <script type=\"application/ld+json\">
            ";
                // line 131
                echo $context["schema"];
                echo "
            </script>
            ";
            }
            $_parent = $context['_parent'];
            unset($context['_seq'], $context['_iterated'], $context['_key'], $context['schema'], $context['_parent'], $context['loop']);
            $context = array_intersect_key($context, $_parent) + $_parent;
            // line 134
            echo "            ";
        }
        // line 135
        echo "            

<script>
(function() {
    'use strict';
    
    // Проверяваме дали скриптът вече е изпълнен
    if (window.euroPriceProcessorLoaded) {
        console.log('⚠️ Euro Price Processor вече е зареден');
        return;
    }
    window.euroPriceProcessorLoaded = true;
    
    // Конфигурация
    const EUR_RATE = 1.95583; // BGN към EUR ставка
    const DEBUG = false; // Смени на true за debugging
    
    // Уникален идентификатор за обработените елементи
    const PROCESSED_ATTR = 'data-euro-processed';
    const EURO_CLASS = 'euro-price-kaielectric';
    
    function log(message, data) {
        if (DEBUG) console.log('🔄 EuroPrice:', message, data || '');
    }
    
    // Функция за конвертиране на цена
    function convertToEuro(priceText) {
        if (!priceText) return null;
        
        let cleanPrice = priceText.toString()
            .replace(/[^\\d.,]/g, '')
            .replace(/(\\d),(\\d{3})/g, '\$1\$2')
            .replace(',', '.');
        
        const price = parseFloat(cleanPrice);
        
        if (isNaN(price) || price <= 0) {
            return null;
        }
        
        const euroPrice = (price / EUR_RATE).toFixed(2).replace('.', ',');
        return euroPrice + '€';
    }
    
    // Функция за проверка дали елементът вече е обработен
    function isAlreadyProcessed(element) {
        return element.hasAttribute(PROCESSED_ATTR) || 
               element.querySelector('.' + EURO_CLASS) ||
               element.textContent.includes('€');
    }
    
    // Функция за намиране на най-подходящия елемент за добавяне на евро цена
    function findBestTargetElement(element) {
        // Ако елементът има деца с цени, намираме най-дълбокия който съдържа цифри
        const childrenWithPrices = Array.from(element.querySelectorAll('*'))
            .filter(child => {
                const text = child.textContent;
                return text.includes('лв') && 
                       /\\d/.test(text) && 
                       child.children.length === 0; // Няма собствени деца
            });
        
        // Ако има деца с цени, използваме първото
        if (childrenWithPrices.length > 0) {
            return childrenWithPrices[0];
        }
        
        // Ако няма деца с цени, използваме самия елемент само ако няма деца
        if (element.children.length === 0) {
            return element;
        }
        
        return null;
    }
    
    // Функция за маркиране на елемент като обработен
    function markAsProcessed(element) {
        element.setAttribute(PROCESSED_ATTR, 'true');
        // Маркираме и родителските елементи до определена дълбочина
        let parent = element.parentElement;
        let depth = 0;
        while (parent && depth < 2) {
            if (parent.textContent.includes('лв')) {
                parent.setAttribute(PROCESSED_ATTR, 'true');
            }
            parent = parent.parentElement;
            depth++;
        }
    }
    
    // Функция за добавяне на евро цена
    function addEuroPrice(element, euroPrice) {
        if (!euroPrice || !element || isAlreadyProcessed(element)) {
            return false;
        }
        
        // Определяме дали да добавим на нов ред
        const shouldUseNewLine = element.closest('.product-price') || 
                                element.classList.contains('product-price') ||
                                element.closest('[class*=\"price\"]');
        
        const euroSpan = document.createElement('span');
        euroSpan.className = EURO_CLASS;
        
        if (shouldUseNewLine) {
            euroSpan.style.cssText = `
                color: #666; 
                font-size: 0.85em; 
                font-weight: normal;
                white-space: nowrap;
                display: block;
                margin-top: 2px;
            `;
            euroSpan.innerHTML = euroPrice; // Без \" / \" за нов ред
        } else {
            euroSpan.style.cssText = `
                color: #666; 
                font-size: 0.85em; 
                margin-left: 5px; 
                font-weight: normal;
                white-space: nowrap;
            `;
            euroSpan.innerHTML = ' / ' + euroPrice;
        }
        
        element.appendChild(euroSpan);
        markAsProcessed(element);
        
        log('Добавена евро цена:', euroPrice + ' към ' + element.tagName + (shouldUseNewLine ? ' (нов ред)' : ' (същия ред)'));
        return true;
    }
    
    // Премахване на всички съществуващи евро цени
    function removeExistingEuroPrices() {
        const existingEuroPrices = document.querySelectorAll('.' + EURO_CLASS);
        existingEuroPrices.forEach(el => el.remove());
        
        // Премахваме атрибутите за обработка
        const processedElements = document.querySelectorAll('[' + PROCESSED_ATTR + ']');
        processedElements.forEach(el => el.removeAttribute(PROCESSED_ATTR));
        
        log('Премахнати ' + existingEuroPrices.length + ' съществуващи евро цени');
    }
    
    // Основна функция за обработка на цените
    
    function processAllPrices() {
        log('🚀 Започваме обработка на цените по специфични класове...');
    
        let processedCount = 0;
    
        const priceSelectors = [
            '.old-price',
            '.new-price', 
            '.price-new',
            '.price-old',
            '.tk_text_free_shipping',
            \".tk_totals_right\",
            '[id^=\"tk_cart_product_total_\"]',
            '#to_office_price',
            '#to_door_price'
        ];
    
        const alreadyProcessedSet = new Set();
    
        priceSelectors.forEach(selector => {
            const elements = document.querySelectorAll(selector);
            log(`Намерени \${elements.length} елемента с селектор: \${selector}`);
    
            elements.forEach(element => {
                const text = element.textContent || '';
    
                if (
                    !isAlreadyProcessed(element) &&
                    !text.includes('€') &&           // Не е вече обработено
                    /\\d/.test(text) &&
                    text.length < 200
                ) {
                    const hasChildren = element.children.length > 0;
    
                    if (hasChildren) {
                        const childrenTypes = Array.from(element.children).map(child => child.tagName.toLowerCase());
                        const hasOnlySimpleChildren = childrenTypes.every(tag => 
                            ['span', 'small', 'em', 'strong', 'b', 'i', 'div'].includes(tag)
                        );
    
                        if (hasOnlySimpleChildren && element.children.length <= 4) {
                            const euroPrice = convertToEuro(text);
                            if (euroPrice && addEuroPrice(element, euroPrice)) {
                                processedCount++;
                                alreadyProcessedSet.add(element);
                                log(`Обработен \${selector}: \${text.substring(0, 30)}...`);
                            }
                        }
                    } else {
                        const euroPrice = convertToEuro(text);
                        if (euroPrice && addEuroPrice(element, euroPrice)) {
                            processedCount++;
                            alreadyProcessedSet.add(element);
                            log(`Обработен \${selector}: \${text.substring(0, 30)}...`);
                        }
                    }
                }
            });
        });
    
        // Резервно обработване ако не е имало попадения
        if (processedCount === 0) {
            log('Няма намерени елементи със специфичните селектори, търсим общи price класове...');
    
            const generalSelectors = ['.price', '[class*=\"price\"]', '[id*=\"price\"]'];
    
            generalSelectors.forEach(selector => {
                const elements = document.querySelectorAll(selector);
    
                elements.forEach(element => {
                    const text = element.textContent || '';
    
                    if (
                        !alreadyProcessedSet.has(element) &&
                        !isAlreadyProcessed(element) &&
                        !text.includes('€') &&
                        /\\d/.test(text) &&
                        text.length < 100
                    ) {
                        const euroPrice = convertToEuro(text);
                        if (euroPrice && addEuroPrice(element, euroPrice)) {
                            processedCount++;
                            log(`Обработен общ селектор \${selector}: \${text.substring(0, 30)}...`);
                        }
                    }
                });
            });
        }
    
        log('✅ Обработени ' + processedCount + ' нови цени');
        return processedCount;
    }
    
    // Функция за намиране на дълбочината на елемент
    function getElementDepth(element) {
        let depth = 0;
        let parent = element.parentElement;
        while (parent) {
            depth++;
            parent = parent.parentElement;
        }
        return depth;
    }
    
    // Функция за intelligent processing
    function intelligentProcess() {
        const unprocessedPrices = Array.from(document.querySelectorAll('*')).filter(el => {
            return el.textContent.includes('лв') && 
                   !isAlreadyProcessed(el) &&
                   el.textContent.length < 100 &&
                   /\\d/.test(el.textContent);
        });
        
        if (unprocessedPrices.length > 0) {
            log('Намерени ' + unprocessedPrices.length + ' необработени цени');
            return processAllPrices();
        }
        
        return 0;
    }
    
    // Функция за наблюдение на промени в DOM
    function setupObserver() {
        let observerTimeout;
        
        const observer = new MutationObserver(function(mutations) {
            let shouldProcess = false;
            
            mutations.forEach(mutation => {
                mutation.addedNodes.forEach(node => {
                    if (node.nodeType === 1 && node.textContent) {
                        if (node.textContent.includes('лв') && !isAlreadyProcessed(node)) {
                            shouldProcess = true;
                        }
                    }
                });
            });
            
            if (shouldProcess) {
                clearTimeout(observerTimeout);
                observerTimeout = setTimeout(() => {
                    log('🔄 DOM се промени, проверяваме за нови цени...');
                    intelligentProcess();
                }, 300);
            }
        });
        
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
        
        log('👁️ Intelligent observer настроен');
    }
    
    // Инициализация
    function init() {
        log('🎯 Euro Price Converter v3.0 за kaielectric.com');
        
        // Премахваме евентуални стари евро цени
        removeExistingEuroPrices();
        
        // Първоначална обработка
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(intelligentProcess, 500);
            });
        } else {
            setTimeout(intelligentProcess, 500);
        }
        
        // Настройваме observer
        setupObserver();
        
        // Финален контролен check
        setTimeout(() => {
            intelligentProcess();
            log('⏰ Финален контролен check завършен');
        }, 3000);
    }
    
    // Глобални функции за контрол
    window.euroPriceControls = {
        reprocess: function() {
            log('🔧 Ръчно преобработване...');
            removeExistingEuroPrices();
            return processAllPrices();
        },
        
        clear: function() {
            removeExistingEuroPrices();
            log('🧹 Всички евро цени премахнати');
        },
        
        status: function() {
            const euroElements = document.querySelectorAll('.' + EURO_CLASS);
            const processedElements = document.querySelectorAll('[' + PROCESSED_ATTR + ']');
            const duplicates = document.querySelectorAll('[' + PROCESSED_ATTR + '] .' + EURO_CLASS);
            
            console.log('📊 Status:');
            console.log('- Евро цени на страницата:', euroElements.length);
            console.log('- Обработени елементи:', processedElements.length);
            console.log('- Потенциални дублирания:', duplicates.length);
            
            // Показваме примери от дублиранията
            if (duplicates.length > 0) {
                console.log('🔍 Примери от дублирания:');
                Array.from(duplicates).slice(0, 3).forEach((el, i) => {
                    console.log(`\${i + 1}. \${el.closest('[' + PROCESSED_ATTR + ']').outerHTML.substring(0, 200)}...`);
                });
            }
            
            return {
                euroPrices: euroElements.length,
                processedElements: processedElements.length,
                duplicates: duplicates.length
            };
        },
        
        fixDuplicates: function() {
            log('🔧 Поправяне на дублирания...');
            
            // Намираме всички елементи с повече от една евро цена
            const elementsWithMultipleEuros = Array.from(document.querySelectorAll('[' + PROCESSED_ATTR + ']'))
                .filter(el => el.querySelectorAll('.' + EURO_CLASS).length > 1);
            
            elementsWithMultipleEuros.forEach(element => {
                const euroElements = element.querySelectorAll('.' + EURO_CLASS);
                // Оставяме само първата евро цена
                for (let i = 1; i < euroElements.length; i++) {
                    euroElements[i].remove();
                }
            });
            
            log('Премахнати дублирания от ' + elementsWithMultipleEuros.length + ' елемента');
            return elementsWithMultipleEuros.length;
        }
    };
    
    // Стартираме
    init();
    
})();
</script>


<style>
.euro-price-kaielectric {
    color: #666 !important;
    font-size: 0.85em !important;
    font-weight: normal !important;
    margin-left: 5px !important;
    white-space: nowrap !important;
    display: inline !important;
}

/* Специални стилове за различни контексти */
.product-thumb .euro-price-kaielectric {
    color: #555 !important;
    font-size: 0.8em !important;
}

.price-new .euro-price-kaielectric {
    color: #e74c3c !important;
    font-weight: 600 !important;
}

.price-old .euro-price-kaielectric {
    text-decoration: line-through !important;
    color: #999 !important;
    font-size: 0.75em !important;
}

/* Cart/checkout стилове */
.table .euro-price-kaielectric {
    display: block !important;
    margin-left: 0 !important;
    margin-top: 2px !important;
    font-size: 0.8em !important;
    color: #777 !important;
}

/* Responsive стилове */
@media (max-width: 768px) {
    .euro-price-kaielectric {
        display: block !important;
        margin-left: 0 !important;
        margin-top: 3px !important;
        font-size: 0.8em !important;
    }
}

@media (max-width: 480px) {
    .euro-price-kaielectric {
        font-size: 0.75em !important;
    }
}

/* Hover ефекти */
.product-thumb:hover .euro-price-kaielectric {
    color: #333 !important;
    transition: color 0.3s ease;
}

/* Плавна анимация при появяване */
.euro-price-kaielectric {
    opacity: 0;
    animation: fadeInEuroPrice 0.4s ease-in-out forwards;
}

@keyframes fadeInEuroPrice {
    from { 
        opacity: 0; 
        transform: translateX(-5px); 
    }
    to { 
        opacity: 1; 
        transform: translateX(0); 
    }
}

/* Премахване на стари класове ако има */
.product_page_price .price-new > .euro-price-kaielectric,
.product_page_price > .euro-price-kaielectric,
.product_page_price .old-price-format > .euro-price-kaielectric,
.content_price .old-price-format > .euro-price-kaielectric {
    display: none !important;
}
</style>

</body>
</html>";
    }

    public function getTemplateName()
    {
        return "so-revo/template/common/footer.twig";
    }

    public function isTraitable()
    {
        return false;
    }

    public function getDebugInfo()
    {
        return array (  316 => 135,  313 => 134,  304 => 131,  301 => 130,  296 => 129,  294 => 128,  275 => 111,  268 => 107,  261 => 103,  255 => 102,  253 => 101,  245 => 96,  241 => 94,  233 => 90,  228 => 88,  221 => 86,  216 => 84,  212 => 82,  204 => 78,  199 => 76,  192 => 74,  187 => 72,  181 => 70,  178 => 69,  175 => 68,  172 => 67,  169 => 66,  166 => 65,  164 => 64,  161 => 63,  152 => 56,  143 => 49,  139 => 47,  136 => 46,  134 => 45,  131 => 44,  128 => 43,  126 => 42,  123 => 41,  120 => 40,  118 => 39,  115 => 38,  112 => 37,  110 => 36,  107 => 35,  104 => 34,  102 => 33,  99 => 32,  96 => 31,  94 => 30,  91 => 29,  88 => 28,  86 => 27,  83 => 26,  80 => 25,  78 => 24,  75 => 23,  72 => 22,  70 => 21,  67 => 20,  64 => 19,  62 => 18,  59 => 17,  56 => 16,  54 => 15,  51 => 14,  48 => 13,  46 => 12,  43 => 11,  40 => 10,  38 => 9,  35 => 8,  32 => 7,  30 => 6,  27 => 5,  24 => 4,  22 => 3,  19 => 2,);
    }
}
/* {# =========== Show Footer==============#}*/
/* */
/* {% if soconfig.get_settings('typefooter') =='1'%}*/
/* 	{% include theme_directory~'/template/footer/footer1.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* */
/* {% elseif soconfig.get_settings('typefooter') =='2'%}*/
/* 	{% include theme_directory~'/template/footer/footer2.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* 	*/
/* {% elseif soconfig.get_settings('typefooter') =='3'%}*/
/* 	{% include theme_directory~'/template/footer/footer3.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* 	*/
/* {% elseif soconfig.get_settings('typefooter') =='4'%}*/
/* 	{% include theme_directory~'/template/footer/footer4.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* 	*/
/* {% elseif soconfig.get_settings('typefooter') =='5'%}*/
/* 	{% include theme_directory~'/template/footer/footer5.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* 	*/
/* {% elseif soconfig.get_settings('typefooter') =='6'%}*/
/* 	{% include theme_directory~'/template/footer/footer6.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* 	*/
/* {% elseif soconfig.get_settings('typefooter') =='7'%}*/
/* 	{% include theme_directory~'/template/footer/footer7.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* */
/* {% elseif soconfig.get_settings('typefooter') =='8'%}*/
/* 	{% include theme_directory~'/template/footer/footer8.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* 	*/
/* {% elseif soconfig.get_settings('typefooter') =='9'%}*/
/* 	{% include theme_directory~'/template/footer/footer9.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* 	*/
/* {% elseif soconfig.get_settings('typefooter') =='10'%}*/
/* 	{% include theme_directory~'/template/footer/footer10.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* */
/* {% elseif soconfig.get_settings('typefooter') =='11'%}*/
/* 	{% include theme_directory~'/template/footer/footer11.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* */
/* {% elseif soconfig.get_settings('typefooter') =='12'%}*/
/* 	{% include theme_directory~'/template/footer/footer12.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* */
/* {% elseif soconfig.get_settings('typefooter') =='13'%}*/
/* 	{% include theme_directory~'/template/footer/footer13.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* */
/* {% elseif soconfig.get_settings('typefooter') =='14'%}*/
/* 	{% include theme_directory~'/template/footer/footer14.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* 	*/
/* {% elseif soconfig.get_settings('typefooter') =='15'%}*/
/* 	{% include theme_directory~'/template/footer/footer15.twig' with {typefooter: soconfig.get_settings('typefooter')} %}*/
/* */
/* {% endif %}*/
/* */
/* */
/* <div id="previewModal" class="modal fade" tabindex="-1" role="dialog">*/
/*   <div class="modal-dialog modal-lg" role="document">*/
/*     <div class="modal-content">*/
/* 		<div class="modal-header">*/
/* 			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>*/
/* 			<h4 class="modal-title"> {{objlang.get('text_alertaddtocart') }}</h4>*/
/* 		</div>*/
/* 		<div class="modal-body"></div>*/
/*     </div>*/
/*   </div>*/
/* </div>*/
/* {# =========== Show BackToTop==============#}*/
/* */
/* {% if soconfig.get_settings('social_sidebar')  %}*/
/* 	{% if soconfig.get_settings('social_sidebar') == 1 %}*/
/* 		{% set  social_sidebar = 'socialwidgets-left'%}*/
/* 	{% else %}*/
/* 		{% set  social_sidebar = 'socialwidgets-right'%}*/
/* 	{% endif %}*/
/* 	<section class="social-widgets visible-lg {{social_sidebar}} ">*/
/* 		<ul class="items">*/
/* 			{% if soconfig.get_settings('social_fb_status') %} */
/* 			<li class="item item-01 facebook">*/
/* 				<a href="catalog/view/theme/{{ theme_directory }}/template/social/facebook.php?account_fb={{soconfig.get_settings('facebook')}} " class="tab-icon"><span class="fa fa-facebook"></span></a>*/
/* 				<div class="tab-content">*/
/* 					<div class="title"><h5>{{text_title_facebook}}</h5></div>*/
/* 					<div class="loading">*/
/* 						<img class="lazyload" data-sizes="auto" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="catalog/view/theme/{{ theme_directory }}/images/ajax-loader.gif" class="ajaxloader" alt="loader">*/
/* 					</div>*/
/* 				</div>*/
/* 			</li>*/
/* 			{% endif %} */
/* */
/* 			{% if soconfig.get_settings('social_twitter_status') %} */
/* 			<li class="item item-02 twitter">*/
/* 				<a href="catalog/view/theme/{{ theme_directory }}/template/social/twitter.php?account_twitter={{ soconfig.get_settings('twitter')}} " class="tab-icon"><span class="fa fa-twitter"></span></a>*/
/* 				<div class="tab-content">*/
/* 					<div class="title"><h5>{{text_title_twitter}}</h5></div>*/
/* 					<div class="loading">*/
/* 						<img class="lazyload" data-sizes="auto" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="catalog/view/theme/{{ theme_directory }}/images/ajax-loader.gif" class="ajaxloader" alt="loader">*/
/* 					</div>*/
/* 				</div>*/
/* 			</li>*/
/* 			{% endif %} */
/* */
/* 			{% if soconfig.get_settings('social_custom_status') %} */
/* 			<li class="item item-03 youtube">*/
/* 				<div class="tab-icon"><span class="fa fa-youtube"></span></div>*/
/* 				<div class="tab-content">*/
/* 					<div class="loading">*/
/* 						{% if soconfig.get_settings('video_code') %}*/
/* 								{{ soconfig.decode_entities( soconfig.get_settings('video_code') ) }}*/
/* 						{% endif %} */
/* 					</div>*/
/* 				</div>*/
/* 			</li>*/
/* 			{% endif %} */
/* 		</ul>*/
/* 	</section>*/
/* 	*/
/* {% endif %} */
/* */
/* </div>*/
/* <script>*/
/* 	$('#so-groups').css('display', 'none');*/
/* 	*/
/* 	$(window).scroll(function (event) {*/
/*     	var scroll = $(window).scrollTop();*/
/*     	if( scroll > $(window).height()){*/
/*     		$('#so-groups').css('display', 'block');*/
/*     	} else {*/
/*     		$('#so-groups').css('display', 'none');*/
/*     	}*/
/* 	});*/
/* 	*/
/* </script>*/
/* */
/*             {% if schemas_org %}*/
/*             {% for schema in schemas_org %}*/
/*             <script type="application/ld+json">*/
/*             {{ schema }}*/
/*             </script>*/
/*             {% endfor %}*/
/*             {% endif %}*/
/*             */
/* */
/* <script>*/
/* (function() {*/
/*     'use strict';*/
/*     */
/*     // Проверяваме дали скриптът вече е изпълнен*/
/*     if (window.euroPriceProcessorLoaded) {*/
/*         console.log('⚠️ Euro Price Processor вече е зареден');*/
/*         return;*/
/*     }*/
/*     window.euroPriceProcessorLoaded = true;*/
/*     */
/*     // Конфигурация*/
/*     const EUR_RATE = 1.95583; // BGN към EUR ставка*/
/*     const DEBUG = false; // Смени на true за debugging*/
/*     */
/*     // Уникален идентификатор за обработените елементи*/
/*     const PROCESSED_ATTR = 'data-euro-processed';*/
/*     const EURO_CLASS = 'euro-price-kaielectric';*/
/*     */
/*     function log(message, data) {*/
/*         if (DEBUG) console.log('🔄 EuroPrice:', message, data || '');*/
/*     }*/
/*     */
/*     // Функция за конвертиране на цена*/
/*     function convertToEuro(priceText) {*/
/*         if (!priceText) return null;*/
/*         */
/*         let cleanPrice = priceText.toString()*/
/*             .replace(/[^\d.,]/g, '')*/
/*             .replace(/(\d),(\d{3})/g, '$1$2')*/
/*             .replace(',', '.');*/
/*         */
/*         const price = parseFloat(cleanPrice);*/
/*         */
/*         if (isNaN(price) || price <= 0) {*/
/*             return null;*/
/*         }*/
/*         */
/*         const euroPrice = (price / EUR_RATE).toFixed(2).replace('.', ',');*/
/*         return euroPrice + '€';*/
/*     }*/
/*     */
/*     // Функция за проверка дали елементът вече е обработен*/
/*     function isAlreadyProcessed(element) {*/
/*         return element.hasAttribute(PROCESSED_ATTR) || */
/*                element.querySelector('.' + EURO_CLASS) ||*/
/*                element.textContent.includes('€');*/
/*     }*/
/*     */
/*     // Функция за намиране на най-подходящия елемент за добавяне на евро цена*/
/*     function findBestTargetElement(element) {*/
/*         // Ако елементът има деца с цени, намираме най-дълбокия който съдържа цифри*/
/*         const childrenWithPrices = Array.from(element.querySelectorAll('*'))*/
/*             .filter(child => {*/
/*                 const text = child.textContent;*/
/*                 return text.includes('лв') && */
/*                        /\d/.test(text) && */
/*                        child.children.length === 0; // Няма собствени деца*/
/*             });*/
/*         */
/*         // Ако има деца с цени, използваме първото*/
/*         if (childrenWithPrices.length > 0) {*/
/*             return childrenWithPrices[0];*/
/*         }*/
/*         */
/*         // Ако няма деца с цени, използваме самия елемент само ако няма деца*/
/*         if (element.children.length === 0) {*/
/*             return element;*/
/*         }*/
/*         */
/*         return null;*/
/*     }*/
/*     */
/*     // Функция за маркиране на елемент като обработен*/
/*     function markAsProcessed(element) {*/
/*         element.setAttribute(PROCESSED_ATTR, 'true');*/
/*         // Маркираме и родителските елементи до определена дълбочина*/
/*         let parent = element.parentElement;*/
/*         let depth = 0;*/
/*         while (parent && depth < 2) {*/
/*             if (parent.textContent.includes('лв')) {*/
/*                 parent.setAttribute(PROCESSED_ATTR, 'true');*/
/*             }*/
/*             parent = parent.parentElement;*/
/*             depth++;*/
/*         }*/
/*     }*/
/*     */
/*     // Функция за добавяне на евро цена*/
/*     function addEuroPrice(element, euroPrice) {*/
/*         if (!euroPrice || !element || isAlreadyProcessed(element)) {*/
/*             return false;*/
/*         }*/
/*         */
/*         // Определяме дали да добавим на нов ред*/
/*         const shouldUseNewLine = element.closest('.product-price') || */
/*                                 element.classList.contains('product-price') ||*/
/*                                 element.closest('[class*="price"]');*/
/*         */
/*         const euroSpan = document.createElement('span');*/
/*         euroSpan.className = EURO_CLASS;*/
/*         */
/*         if (shouldUseNewLine) {*/
/*             euroSpan.style.cssText = `*/
/*                 color: #666; */
/*                 font-size: 0.85em; */
/*                 font-weight: normal;*/
/*                 white-space: nowrap;*/
/*                 display: block;*/
/*                 margin-top: 2px;*/
/*             `;*/
/*             euroSpan.innerHTML = euroPrice; // Без " / " за нов ред*/
/*         } else {*/
/*             euroSpan.style.cssText = `*/
/*                 color: #666; */
/*                 font-size: 0.85em; */
/*                 margin-left: 5px; */
/*                 font-weight: normal;*/
/*                 white-space: nowrap;*/
/*             `;*/
/*             euroSpan.innerHTML = ' / ' + euroPrice;*/
/*         }*/
/*         */
/*         element.appendChild(euroSpan);*/
/*         markAsProcessed(element);*/
/*         */
/*         log('Добавена евро цена:', euroPrice + ' към ' + element.tagName + (shouldUseNewLine ? ' (нов ред)' : ' (същия ред)'));*/
/*         return true;*/
/*     }*/
/*     */
/*     // Премахване на всички съществуващи евро цени*/
/*     function removeExistingEuroPrices() {*/
/*         const existingEuroPrices = document.querySelectorAll('.' + EURO_CLASS);*/
/*         existingEuroPrices.forEach(el => el.remove());*/
/*         */
/*         // Премахваме атрибутите за обработка*/
/*         const processedElements = document.querySelectorAll('[' + PROCESSED_ATTR + ']');*/
/*         processedElements.forEach(el => el.removeAttribute(PROCESSED_ATTR));*/
/*         */
/*         log('Премахнати ' + existingEuroPrices.length + ' съществуващи евро цени');*/
/*     }*/
/*     */
/*     // Основна функция за обработка на цените*/
/*     */
/*     function processAllPrices() {*/
/*         log('🚀 Започваме обработка на цените по специфични класове...');*/
/*     */
/*         let processedCount = 0;*/
/*     */
/*         const priceSelectors = [*/
/*             '.old-price',*/
/*             '.new-price', */
/*             '.price-new',*/
/*             '.price-old',*/
/*             '.tk_text_free_shipping',*/
/*             ".tk_totals_right",*/
/*             '[id^="tk_cart_product_total_"]',*/
/*             '#to_office_price',*/
/*             '#to_door_price'*/
/*         ];*/
/*     */
/*         const alreadyProcessedSet = new Set();*/
/*     */
/*         priceSelectors.forEach(selector => {*/
/*             const elements = document.querySelectorAll(selector);*/
/*             log(`Намерени ${elements.length} елемента с селектор: ${selector}`);*/
/*     */
/*             elements.forEach(element => {*/
/*                 const text = element.textContent || '';*/
/*     */
/*                 if (*/
/*                     !isAlreadyProcessed(element) &&*/
/*                     !text.includes('€') &&           // Не е вече обработено*/
/*                     /\d/.test(text) &&*/
/*                     text.length < 200*/
/*                 ) {*/
/*                     const hasChildren = element.children.length > 0;*/
/*     */
/*                     if (hasChildren) {*/
/*                         const childrenTypes = Array.from(element.children).map(child => child.tagName.toLowerCase());*/
/*                         const hasOnlySimpleChildren = childrenTypes.every(tag => */
/*                             ['span', 'small', 'em', 'strong', 'b', 'i', 'div'].includes(tag)*/
/*                         );*/
/*     */
/*                         if (hasOnlySimpleChildren && element.children.length <= 4) {*/
/*                             const euroPrice = convertToEuro(text);*/
/*                             if (euroPrice && addEuroPrice(element, euroPrice)) {*/
/*                                 processedCount++;*/
/*                                 alreadyProcessedSet.add(element);*/
/*                                 log(`Обработен ${selector}: ${text.substring(0, 30)}...`);*/
/*                             }*/
/*                         }*/
/*                     } else {*/
/*                         const euroPrice = convertToEuro(text);*/
/*                         if (euroPrice && addEuroPrice(element, euroPrice)) {*/
/*                             processedCount++;*/
/*                             alreadyProcessedSet.add(element);*/
/*                             log(`Обработен ${selector}: ${text.substring(0, 30)}...`);*/
/*                         }*/
/*                     }*/
/*                 }*/
/*             });*/
/*         });*/
/*     */
/*         // Резервно обработване ако не е имало попадения*/
/*         if (processedCount === 0) {*/
/*             log('Няма намерени елементи със специфичните селектори, търсим общи price класове...');*/
/*     */
/*             const generalSelectors = ['.price', '[class*="price"]', '[id*="price"]'];*/
/*     */
/*             generalSelectors.forEach(selector => {*/
/*                 const elements = document.querySelectorAll(selector);*/
/*     */
/*                 elements.forEach(element => {*/
/*                     const text = element.textContent || '';*/
/*     */
/*                     if (*/
/*                         !alreadyProcessedSet.has(element) &&*/
/*                         !isAlreadyProcessed(element) &&*/
/*                         !text.includes('€') &&*/
/*                         /\d/.test(text) &&*/
/*                         text.length < 100*/
/*                     ) {*/
/*                         const euroPrice = convertToEuro(text);*/
/*                         if (euroPrice && addEuroPrice(element, euroPrice)) {*/
/*                             processedCount++;*/
/*                             log(`Обработен общ селектор ${selector}: ${text.substring(0, 30)}...`);*/
/*                         }*/
/*                     }*/
/*                 });*/
/*             });*/
/*         }*/
/*     */
/*         log('✅ Обработени ' + processedCount + ' нови цени');*/
/*         return processedCount;*/
/*     }*/
/*     */
/*     // Функция за намиране на дълбочината на елемент*/
/*     function getElementDepth(element) {*/
/*         let depth = 0;*/
/*         let parent = element.parentElement;*/
/*         while (parent) {*/
/*             depth++;*/
/*             parent = parent.parentElement;*/
/*         }*/
/*         return depth;*/
/*     }*/
/*     */
/*     // Функция за intelligent processing*/
/*     function intelligentProcess() {*/
/*         const unprocessedPrices = Array.from(document.querySelectorAll('*')).filter(el => {*/
/*             return el.textContent.includes('лв') && */
/*                    !isAlreadyProcessed(el) &&*/
/*                    el.textContent.length < 100 &&*/
/*                    /\d/.test(el.textContent);*/
/*         });*/
/*         */
/*         if (unprocessedPrices.length > 0) {*/
/*             log('Намерени ' + unprocessedPrices.length + ' необработени цени');*/
/*             return processAllPrices();*/
/*         }*/
/*         */
/*         return 0;*/
/*     }*/
/*     */
/*     // Функция за наблюдение на промени в DOM*/
/*     function setupObserver() {*/
/*         let observerTimeout;*/
/*         */
/*         const observer = new MutationObserver(function(mutations) {*/
/*             let shouldProcess = false;*/
/*             */
/*             mutations.forEach(mutation => {*/
/*                 mutation.addedNodes.forEach(node => {*/
/*                     if (node.nodeType === 1 && node.textContent) {*/
/*                         if (node.textContent.includes('лв') && !isAlreadyProcessed(node)) {*/
/*                             shouldProcess = true;*/
/*                         }*/
/*                     }*/
/*                 });*/
/*             });*/
/*             */
/*             if (shouldProcess) {*/
/*                 clearTimeout(observerTimeout);*/
/*                 observerTimeout = setTimeout(() => {*/
/*                     log('🔄 DOM се промени, проверяваме за нови цени...');*/
/*                     intelligentProcess();*/
/*                 }, 300);*/
/*             }*/
/*         });*/
/*         */
/*         observer.observe(document.body, {*/
/*             childList: true,*/
/*             subtree: true*/
/*         });*/
/*         */
/*         log('👁️ Intelligent observer настроен');*/
/*     }*/
/*     */
/*     // Инициализация*/
/*     function init() {*/
/*         log('🎯 Euro Price Converter v3.0 за kaielectric.com');*/
/*         */
/*         // Премахваме евентуални стари евро цени*/
/*         removeExistingEuroPrices();*/
/*         */
/*         // Първоначална обработка*/
/*         if (document.readyState === 'loading') {*/
/*             document.addEventListener('DOMContentLoaded', function() {*/
/*                 setTimeout(intelligentProcess, 500);*/
/*             });*/
/*         } else {*/
/*             setTimeout(intelligentProcess, 500);*/
/*         }*/
/*         */
/*         // Настройваме observer*/
/*         setupObserver();*/
/*         */
/*         // Финален контролен check*/
/*         setTimeout(() => {*/
/*             intelligentProcess();*/
/*             log('⏰ Финален контролен check завършен');*/
/*         }, 3000);*/
/*     }*/
/*     */
/*     // Глобални функции за контрол*/
/*     window.euroPriceControls = {*/
/*         reprocess: function() {*/
/*             log('🔧 Ръчно преобработване...');*/
/*             removeExistingEuroPrices();*/
/*             return processAllPrices();*/
/*         },*/
/*         */
/*         clear: function() {*/
/*             removeExistingEuroPrices();*/
/*             log('🧹 Всички евро цени премахнати');*/
/*         },*/
/*         */
/*         status: function() {*/
/*             const euroElements = document.querySelectorAll('.' + EURO_CLASS);*/
/*             const processedElements = document.querySelectorAll('[' + PROCESSED_ATTR + ']');*/
/*             const duplicates = document.querySelectorAll('[' + PROCESSED_ATTR + '] .' + EURO_CLASS);*/
/*             */
/*             console.log('📊 Status:');*/
/*             console.log('- Евро цени на страницата:', euroElements.length);*/
/*             console.log('- Обработени елементи:', processedElements.length);*/
/*             console.log('- Потенциални дублирания:', duplicates.length);*/
/*             */
/*             // Показваме примери от дублиранията*/
/*             if (duplicates.length > 0) {*/
/*                 console.log('🔍 Примери от дублирания:');*/
/*                 Array.from(duplicates).slice(0, 3).forEach((el, i) => {*/
/*                     console.log(`${i + 1}. ${el.closest('[' + PROCESSED_ATTR + ']').outerHTML.substring(0, 200)}...`);*/
/*                 });*/
/*             }*/
/*             */
/*             return {*/
/*                 euroPrices: euroElements.length,*/
/*                 processedElements: processedElements.length,*/
/*                 duplicates: duplicates.length*/
/*             };*/
/*         },*/
/*         */
/*         fixDuplicates: function() {*/
/*             log('🔧 Поправяне на дублирания...');*/
/*             */
/*             // Намираме всички елементи с повече от една евро цена*/
/*             const elementsWithMultipleEuros = Array.from(document.querySelectorAll('[' + PROCESSED_ATTR + ']'))*/
/*                 .filter(el => el.querySelectorAll('.' + EURO_CLASS).length > 1);*/
/*             */
/*             elementsWithMultipleEuros.forEach(element => {*/
/*                 const euroElements = element.querySelectorAll('.' + EURO_CLASS);*/
/*                 // Оставяме само първата евро цена*/
/*                 for (let i = 1; i < euroElements.length; i++) {*/
/*                     euroElements[i].remove();*/
/*                 }*/
/*             });*/
/*             */
/*             log('Премахнати дублирания от ' + elementsWithMultipleEuros.length + ' елемента');*/
/*             return elementsWithMultipleEuros.length;*/
/*         }*/
/*     };*/
/*     */
/*     // Стартираме*/
/*     init();*/
/*     */
/* })();*/
/* </script>*/
/* */
/* */
/* <style>*/
/* .euro-price-kaielectric {*/
/*     color: #666 !important;*/
/*     font-size: 0.85em !important;*/
/*     font-weight: normal !important;*/
/*     margin-left: 5px !important;*/
/*     white-space: nowrap !important;*/
/*     display: inline !important;*/
/* }*/
/* */
/* /* Специални стилове за различни контексти *//* */
/* .product-thumb .euro-price-kaielectric {*/
/*     color: #555 !important;*/
/*     font-size: 0.8em !important;*/
/* }*/
/* */
/* .price-new .euro-price-kaielectric {*/
/*     color: #e74c3c !important;*/
/*     font-weight: 600 !important;*/
/* }*/
/* */
/* .price-old .euro-price-kaielectric {*/
/*     text-decoration: line-through !important;*/
/*     color: #999 !important;*/
/*     font-size: 0.75em !important;*/
/* }*/
/* */
/* /* Cart/checkout стилове *//* */
/* .table .euro-price-kaielectric {*/
/*     display: block !important;*/
/*     margin-left: 0 !important;*/
/*     margin-top: 2px !important;*/
/*     font-size: 0.8em !important;*/
/*     color: #777 !important;*/
/* }*/
/* */
/* /* Responsive стилове *//* */
/* @media (max-width: 768px) {*/
/*     .euro-price-kaielectric {*/
/*         display: block !important;*/
/*         margin-left: 0 !important;*/
/*         margin-top: 3px !important;*/
/*         font-size: 0.8em !important;*/
/*     }*/
/* }*/
/* */
/* @media (max-width: 480px) {*/
/*     .euro-price-kaielectric {*/
/*         font-size: 0.75em !important;*/
/*     }*/
/* }*/
/* */
/* /* Hover ефекти *//* */
/* .product-thumb:hover .euro-price-kaielectric {*/
/*     color: #333 !important;*/
/*     transition: color 0.3s ease;*/
/* }*/
/* */
/* /* Плавна анимация при появяване *//* */
/* .euro-price-kaielectric {*/
/*     opacity: 0;*/
/*     animation: fadeInEuroPrice 0.4s ease-in-out forwards;*/
/* }*/
/* */
/* @keyframes fadeInEuroPrice {*/
/*     from { */
/*         opacity: 0; */
/*         transform: translateX(-5px); */
/*     }*/
/*     to { */
/*         opacity: 1; */
/*         transform: translateX(0); */
/*     }*/
/* }*/
/* */
/* /* Премахване на стари класове ако има *//* */
/* .product_page_price .price-new > .euro-price-kaielectric,*/
/* .product_page_price > .euro-price-kaielectric,*/
/* .product_page_price .old-price-format > .euro-price-kaielectric,*/
/* .content_price .old-price-format > .euro-price-kaielectric {*/
/*     display: none !important;*/
/* }*/
/* </style>*/
/* */
/* </body>*/
/* </html>*/
